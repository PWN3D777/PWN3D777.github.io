<!DOCTYPE html>
<html class="direction--ltr"lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Cicada-Windows-Easy | Pwn3d777</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Cicada-Windows-Easy" />
<meta name="author" content="GitHub User" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Cicada" />
<meta property="og:description" content="Cicada" />
<link rel="canonical" href="https://your-site-url/writeups/2025/07/14/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647.html" />
<meta property="og:url" content="https://your-site-url/writeups/2025/07/14/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647.html" />
<meta property="og:site_name" content="Pwn3d777" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-07-14T16:05:57+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Cicada-Windows-Easy" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"GitHub User"},"dateModified":"2025-07-14T16:05:57+00:00","datePublished":"2025-07-14T16:05:57+00:00","description":"Cicada","headline":"Cicada-Windows-Easy","mainEntityOfPage":{"@type":"WebPage","@id":"https://your-site-url/writeups/2025/07/14/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647.html"},"url":"https://your-site-url/writeups/2025/07/14/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" />
  <link rel="stylesheet" href="/assets/css/magnific-popup.css"><link type="application/atom+xml" rel="alternate" href="https://your-site-url/feed.xml" title="Pwn3d777" /><script src="https://code.jquery.com/jquery-3.2.0.min.js"></script> 
  <script src="/assets/js/jquery.magnific-popup.js"></script>
</head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">Pwn3d777<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        
        
        <a class="color-cyan-hover" href="https://twitter.com/bitbrain_"><i class="fab fa-twitter-square"></i></a>
        
        
        
        <a class="color-red-hover" href="https://bitbrain.itch.io"><i class="fab fa-itch-io"></i></a>
        
        
        
        <a class="color-purple-hover" href="https://github.com/bitbrain"><i class="fab fa-github-square"></i></a>
        
        
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
<div class="post">
  <h1 class="post-title">Cicada-Windows-Easy</h1>
  
  <div class="post-date">
    Published on 14 Jul 2025
    
  </div>
  
  <h1 id="cicada">Cicada</h1>

<h1 id="1-enumeration">1. Enumeration</h1>

<p>Start nmap looking for open ports
<br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image.png" alt="image.png" />
<br /><br />
Kerberos authentication is used, smb protocol running on 445, a good way to start could be checking for public files shared in smb, we also can note that rpc is used in port135
<br /><br /></p>
<h1 id="2-user-flag">2. User flag</h1>
<p><br /><br />
We use GUEST user and find a public file on HR directory
<br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_1.png" alt="image.png" />
<br /><br />
That file is disclosing a default password, it might happen that a user just forgot to change it, let’s break it up
<br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_2.png" alt="image.png" />
<br /><br />
We can perform a user recognizing using kerbrute, but for this case it is no useful
<br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_3.png" alt="image.png" />
<br /><br />
Consequently we use <code class="language-plaintext highlighter-rouge">—rid-brute</code> in crackmapexec, this flag helps us to carry out a rid brute force attack. Basically it will try to get valid user accounts making requests using known RIDs (Relative IDentifiers) when it finds valid accounts, the system will respond with information related with that RID.
What we are going to do is take all this output saving it to a next .txt file, and using VIM we are going to filter (SidTypeuser) we can use regular expressions like:
<br /><br /></p>
<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">##</span><span class="nx">Eliminar</span> <span class="nx">todas</span> <span class="nx">las</span> <span class="nx">lineas</span> <span class="nx">que</span> <span class="nx">no</span> <span class="nx">tengan</span> <span class="p">(</span><span class="nx">SidTypeUser</span><span class="p">)</span>
<span class="p">:</span><span class="nx">g</span><span class="o">!</span><span class="sr">/SidTypeUser/</span><span class="nx">d</span>
<span class="err">##</span><span class="nx">Eliminar</span> <span class="nx">todo</span> <span class="nx">lo</span> <span class="nx">que</span> <span class="nx">este</span> <span class="nx">detras</span> <span class="nx">de</span> <span class="nx">CICADA</span><span class="o">\</span>
<span class="p">:</span><span class="o">%</span><span class="nx">s</span><span class="o">/</span><span class="p">.</span><span class="o">*</span><span class="err">\</span><span class="p">(</span><span class="nx">CICADA</span><span class="err">\\</span><span class="p">)</span><span class="c1">//g</span>
<span class="err">##</span><span class="nx">Eliminar</span> <span class="p">(</span><span class="nx">SidTypeGroup</span><span class="p">)</span>
<span class="p">:</span><span class="o">%</span><span class="nx">s</span><span class="o">/</span><span class="p">(</span><span class="nx">SidTypeUser</span><span class="p">)</span><span class="c1">//g</span>
</code></pre></div></div>
<p><br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_4.png" alt="image.png" />
<br /><br />
After that we could spray the password in all the usernames found on it.
<br /><br />
We are going to find that michael.wrightson haven’t change his password, we can access to his shared files, but as we see below there are no more than the guest user can see
<br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_5.png" alt="image.png" />
<br /><br />
Go to rpcclient we might get more information there
<br /><br /></p>
<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">getdompwinfo</span> <span class="err">#</span><span class="nx">Retrieves</span> <span class="nx">domain</span> <span class="nx">password</span> <span class="nx">information</span>
<span class="nx">enumdomusers</span> <span class="err">#</span><span class="nx">Retrieves</span> <span class="nx">users</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">domain</span> <span class="kd">with</span> <span class="nx">their</span> <span class="nx">rid</span>
<span class="nx">queryuser</span> <span class="err">#</span><span class="nx">Retrieves</span> <span class="nx">information</span> <span class="nx">about</span> <span class="nx">the</span> <span class="nx">given</span> <span class="nx">user</span>
</code></pre></div></div>
<p><br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_6.png" alt="image.png" />
<br /><br />
That’s how we are able to get to dev directory inside smb protocol using david password.
<br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_7.png" alt="image.png" />
<br /><br />
Download the file contained in DEV
<br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_8.png" alt="image.png" />
<br /><br />
There we can find Powershell code, where emily password is changed
<br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_9.png" alt="image.png" />
<br /><br />
Got the user flag
<br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_10.png" alt="image.png" />
<br /><br /></p>
<h1 id="3priv-esc">3.Priv esc</h1>
<p><br /><br />
Enumerate privileges using
<br /><br /></p>
<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">whoami</span> <span class="o">/</span><span class="nx">all</span>

<span class="err">##</span><span class="nx">We</span> <span class="nx">have</span> <span class="nx">SeBackUpPrivilege</span>  <span class="o">-</span> <span class="nx">BackUp</span> <span class="nx">files</span> <span class="nx">and</span> <span class="nx">directories</span>
<span class="err">##</span><span class="nx">It</span> <span class="nx">means</span> <span class="nx">we</span> <span class="nx">can</span> <span class="nx">proceed</span> <span class="k">as</span> <span class="nx">shown</span> <span class="nx">below</span>
</code></pre></div></div>
<p><br /><br />
We are going to use the command <code class="language-plaintext highlighter-rouge">reg save</code> to save log sections with determined files:
<br /><br /></p>
<ul>
  <li>HKLM/SAM (HKEY_LOCAL_MACHINE)/(Security Account Manager): This path contains user accounts and their passwords in form of hashes. This includes local users and security policies associated.</li>
  <li>HKLM/SYSTEM: This path contains critical information about the configuration system, including hardware, drivers, and services
<br /><br />
    <div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">reg</span> <span class="nx">save</span> <span class="nx">hklm</span><span class="err">\</span><span class="nx">sam</span> <span class="nx">sam</span>
<span class="nx">reg</span> <span class="nx">save</span> <span class="nx">hklm</span><span class="err">\</span><span class="nx">system</span> <span class="nx">system</span>
</code></pre></div>    </div>
    <p><br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_11.png" alt="image.png" />
<br /><br />
Download those files and use impacket-secretsdump or pypykatz and it will give us the administrator and other users hashes
<br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_12.png" alt="image.png" />
<br /><br />
<img src="/assets/images/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647_image_13.png" alt="image.png" />
<br /><br />
Machine pwned!!!!
<script src="/assets/js/matrix-overlay.js"></script></p>
  </li>
</ul>

<link rel="stylesheet" href="/assets/css/imagesstyle.css" />


</div>


<div class="comments">
<div id="disqus_thread"></div>
<script>
 var disqus_config = function () {
     this.page.url = 'https://your-site-url/writeups/2025/07/14/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647.html';
     this.page.identifier = '/writeups/2025/07/14/e34b879c-001c-4c4b-a449-d4ac27754f23-export-929658c5-bf6a-4967-b658-268b21bac647';
     this.page.title = 'Cicada-Windows-Easy';
 };

 (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
     var d = document, s = d.createElement('script');

     s.src = '//<your-disqus-shortname>.disqus.com/embed.js';

     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/writeups/2025/08/09/dddc540b-b15a-4ca6-a4e5-f95074025ea8-export-c6a747d0-44c2-4f1a-b1f3-cc9f14194be4.html">
            University-Windows-Insane
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/writeups/2025/08/04/d2fd2792-68e0-4168-9904-f90f3bf63609-export-0ee8c1a5-de29-43f8-b0f4-339fa55d28de.html">
            Code-Linux-Easy
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/writeups/2025/07/26/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947.html">
            Cypher-Linux-Medium
          </a>
        </h3>
      </li>
    
  </ul>
</div>






<script>
  let i = 0;
  const text = '';
  const speed = parseInt('50');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();

  // Image modal
  var $imgs = [];
  $('img').each(function(idx) {
    var obj = {
      src: $(this).attr('src')
    }
    $imgs.push(obj);
    var elem = $(this);
    $(this).click(function() {
      $('.modal').magnificPopup('open', idx);
    });
  });

  $('.modal').magnificPopup({
    items: $imgs,
    type: 'image',
    closeOnContentClick: true,
    mainClass: 'mfp-img-mobile',
    image: {
      verticalFit: true
    }
    
  });
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/bitbrain/jekyll-dash">dash</a> theme for Jekyll by <a href="https://github.com/bitbrain">bitbrain</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
