<!DOCTYPE html>
<html class="direction--ltr"lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>PermX e9c17d0d44624c318129763a39c15b44 | Pwn3d777</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="PermX e9c17d0d44624c318129763a39c15b44" />
<meta name="author" content="GitHub User" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="PermX" />
<meta property="og:description" content="PermX" />
<link rel="canonical" href="https://your-site-url/writeups/2025/07/12/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358.html" />
<meta property="og:url" content="https://your-site-url/writeups/2025/07/12/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358.html" />
<meta property="og:site_name" content="Pwn3d777" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-07-12T16:05:57+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="PermX e9c17d0d44624c318129763a39c15b44" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"GitHub User"},"dateModified":"2025-07-12T16:05:57+00:00","datePublished":"2025-07-12T16:05:57+00:00","description":"PermX","headline":"PermX e9c17d0d44624c318129763a39c15b44","mainEntityOfPage":{"@type":"WebPage","@id":"https://your-site-url/writeups/2025/07/12/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358.html"},"url":"https://your-site-url/writeups/2025/07/12/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" />
  <link rel="stylesheet" href="/assets/css/magnific-popup.css"><link type="application/atom+xml" rel="alternate" href="https://your-site-url/feed.xml" title="Pwn3d777" /><script src="https://code.jquery.com/jquery-3.2.0.min.js"></script> 
  <script src="/assets/js/jquery.magnific-popup.js"></script>
</head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">Pwn3d777<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        
        
        <a class="color-cyan-hover" href="https://twitter.com/bitbrain_"><i class="fab fa-twitter-square"></i></a>
        
        
        
        <a class="color-red-hover" href="https://bitbrain.itch.io"><i class="fab fa-itch-io"></i></a>
        
        
        
        <a class="color-purple-hover" href="https://github.com/bitbrain"><i class="fab fa-github-square"></i></a>
        
        
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
  <div class="author-box">

<div class="description">This is my blog, here you will find more information about me, in addition to my work on HackTheBox and some interesting apps i've developed
</div>

</div>


<div class="post">
  <h1 class="post-title">PermX e9c17d0d44624c318129763a39c15b44</h1>
  
  <div class="post-date">
    Published on 12 Jul 2025
    
  </div>
  
  <h1 id="permx">PermX</h1>

<h1 id="1-enumeration">1. Enumeration</h1>

<p>We start with scanning ports using nmap</p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled.png" alt="Untitled" /></p>

<p>We went to the http service but it didn’t have anything interesting at least on the principal subdomain, so use ffuf to recognize another dns this time to make the request in the correct way we need fuzz the header of the request, remaining the url</p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_1.png" alt="Untitled" /></p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_2.png" alt="Untitled" /></p>

<h1 id="2-user-flag">2. User flag</h1>

<p>There is a chamilo service</p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_3.png" alt="Untitled" /></p>

<p>Search for vulnerabilities which an unauthenticated user can bypass the web application</p>

<h3 id="cve-2023-4220">CVE-2023-4220</h3>

<p>To exploit this vulnerability which is a RFI we need to assure the existence of the next directory</p>

<p><code class="language-plaintext highlighter-rouge">/main/inc/lib/javascript/bigupload/files</code></p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_4.png" alt="Untitled" /></p>

<p>Create a revshell and upload it in the web, then call it to get control as data</p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_5.png" alt="Untitled" /></p>

<p>Check configuration files</p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_6.png" alt="Untitled" /></p>

<p>Find credentials to a db, we can try those credentials to know if they’re associated with the principal user of the machine (MTZ)</p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_7.png" alt="Untitled" /></p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_8.png" alt="Untitled" /></p>

<h1 id="3priv-esc">3.Priv esc</h1>

<p>Review which commands we can run with sudo, and there is a script available, this code allows user mtz to set sudo permissions on his directory, and we can find some security filters mitigating reverse path traverse</p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_9.png" alt="Untitled" /></p>

<p>This one is easy just create a symlink of the file sudoers and set it up to grant mtz full sudo permissions</p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_10.png" alt="Untitled" /></p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_11.png" alt="Untitled" /></p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_12.png" alt="Untitled" /></p>

<p><img src="/assets/images/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358_Untitled_13.png" alt="Untitled" /></p>

<p>Machine PWNED#@!</p>

</div>


<div class="comments">
<div id="disqus_thread"></div>
<script>
 var disqus_config = function () {
     this.page.url = 'https://your-site-url/writeups/2025/07/12/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358.html';
     this.page.identifier = '/writeups/2025/07/12/95c97937-1eca-41c8-a82b-ccc870e8ad80-export-21d1b79f-8117-4c76-bc79-a47eb4066358';
     this.page.title = 'PermX e9c17d0d44624c318129763a39c15b44';
 };

 (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
     var d = document, s = d.createElement('script');

     s.src = '//<your-disqus-shortname>.disqus.com/embed.js';

     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/writeups/2025/07/17/ffa4a87e-38af-497f-af3d-e8e50cfff51d-export-1b877186-ee75-440e-b2af-33e8bf6b294e.html">
            Dog 207b952552918059ae99cbb25a8392ef
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/writeups/2025/07/17/79cfbba1-5d00-4be3-9024-410aeb127310-export-17230101-c486-4db1-a5be-7f8c4dbff5b9.html">
            Titanic 1eab9525529180a9b52fc9a7eb126a50
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/writeups/2025/07/17/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb.html">
            Cat 1abb9525529180ae82d4f25f2121346a
          </a>
        </h3>
      </li>
    
  </ul>
</div>






<script>
  let i = 0;
  const text = '';
  const speed = parseInt('50');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();

  // Image modal
  var $imgs = [];
  $('img').each(function(idx) {
    var obj = {
      src: $(this).attr('src')
    }
    $imgs.push(obj);
    var elem = $(this);
    $(this).click(function() {
      $('.modal').magnificPopup('open', idx);
    });
  });

  $('.modal').magnificPopup({
    items: $imgs,
    type: 'image',
    closeOnContentClick: true,
    mainClass: 'mfp-img-mobile',
    image: {
      verticalFit: true
    }
    
  });
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/bitbrain/jekyll-dash">dash</a> theme for Jekyll by <a href="https://github.com/bitbrain">bitbrain</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
