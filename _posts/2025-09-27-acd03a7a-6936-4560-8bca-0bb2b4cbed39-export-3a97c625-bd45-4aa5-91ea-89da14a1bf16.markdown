---
layout: post
title: "Underpass-Linux-Easy"
date:   2025-07-15 12:05:57 -0400
categories: writeups
thumb: /assets/images/logos/456a4d2e52f182847fb0a2dba0420a44.webp
---

# Underpass

# 1. Enumeration
<br/><br/>
Start checking public open ports
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image.png' | relative_url }})
<br/><br/>
On web application there is a apache2 default page
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_1.png' | relative_url }})
<br/><br/>
We tried to find new endpoints, but it seems to don’t have anything else to trigger around here
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_2.png' | relative_url }})
<br/><br/>
We decide to scan udp top ports to see if there are interesting services running on it, we have a snmp service, which has underpass with its version disclosed
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_3.png' | relative_url }})
<br/><br/>
snmpwalk is a tool to enumerate this kind of situations, we use -c public to refer this community info, and the version where we can access information is 2c, now we have a user and a clue about what service is really running in  80 port 
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_4.png' | relative_url }})
<br/><br/>
# 2. User flag
<br/><br/>
On github dalo repo we have more about what we are trying to find
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_5.png' | relative_url }})
<br/><br/>
Finally we have more of it
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_6.png' | relative_url }})
<br/><br/>
Taking this as a base line, we could fuzz new endpoints or try out some default ones as login
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_7.png' | relative_url }})
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_8.png' | relative_url }})
<br/><br/>
As user login default creds didn’t work, but our recognize on upd port says that some configurations are default configurations
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_9.png' | relative_url }})
<br/><br/>
So access to a operators login 
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_10.png' | relative_url }})
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_11.png' | relative_url }})
<br/><br/>
Here we have a login successful and access to users and its creds
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_12.png' | relative_url }})
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_13.png' | relative_url }})
<br/><br/>
# 3.Priv esc
<br/><br/>
Check if we can run something as root
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_14.png' | relative_url }})
<br/><br/>
We have mosh which is a tool to connect to a server via CLI, in its docs there are some flags where we can execute commands
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_15.png' | relative_url }})
<br/><br/>
—server flag allows to specify the command that will be used in the remote server to init the process in Mosh. This is useful if custom configurations
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_16.png' | relative_url }})
<br/><br/>
Basically we are going to start and connect to mosh-server as root in localhost 
<br/><br/>
![image.png]({{ '/assets/images/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16/acd03a7a-6936-4560-8bca-0bb2b4cbed39-export-3a97c625-bd45-4aa5-91ea-89da14a1bf16_image_17.png' | relative_url }})
<br/><br/>
Machine pwned!!!
<script src="{{ '/assets/js/matrix-overlay.js' | relative_url }}"></script>


<link rel="stylesheet" href="{{ '/assets/css/imagesstyle.css' | relative_url }}">
