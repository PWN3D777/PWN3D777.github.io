---
layout: post
title: "Editorial 63d0cc16bccf469b8694593a80281674"
date:   2025-07-12 12:05:57 -0400
categories: writeups
---

# Editorial

# 1. Enumeration

We start port scanning, we may need to find credentials to port 22 on ort 80

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled.png' | relative_url }})

Let’s check the http service 

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_1.png' | relative_url }})

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_2.png' | relative_url }})

# 2. User flag

Looking for directories, there are a section where we can upload information about some book to publish it.

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_3.png' | relative_url }})

If we seek into burp trying to upload information those inputs are sanitized, but the url information seems suspicious, but to send a properly request to the server we will need to click preview button

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_4.png' | relative_url }})

Try to exploit a SSRF using common ports like 8000, 8080, as we can see on port 5000 there is a service running, and it respond with a file which we can download

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_5.png' | relative_url }})

Once we downloaded it, we found others directory paths, where there might be information

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_6.png' | relative_url }})

Repeat the previous steps and find those credentials

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_7.png' | relative_url }})

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_8.png' | relative_url }})

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_9.png' | relative_url }})

# 3.Priv esc

Now we are dev user, and he has access to a repository. In there we cannot find the easy way to escalate our privileges but on logs we can see that someone did a commit where dev user is involved 

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_10.png' | relative_url }})

Check the before version of the page, and make a lateral movement

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_11.png' | relative_url }})

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_12.png' | relative_url }})

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_13.png' | relative_url }})

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_14.png' | relative_url }})

Now we are prod user, searching his permission on sudo we can see that python is used to manage versions control

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_15.png' | relative_url }})

- CVE-2022-24439
    
    Affected versions of this package are vulnerable to Remote Code Execution (RCE) due to improper user input validation, which makes it possible to inject a maliciously crafted remote URL into the clone command. Exploiting this vulnerability is possible because the library makes external calls to `git` without sufficient sanitization of input arguments. This is only relevant when enabling the `ext` transport protocol.
    

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_16.png' | relative_url }})

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_17.png' | relative_url }})

Root flag got it but we are hungry of full control, we can make a rev shell using netcat

![Untitled]({{ '/assets/images/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d/f760e2de-d5a0-4b82-99c0-2ec1f2a7d6de-export-cb07417d-5847-4cb8-b8a3-8ec1b9fd933d_Untitled_18.png' | relative_url }})

<script src="{{ '/assets/js/matrix-overlay.js' | relative_url }}"></script>
